{% extends 'admin/base.html.twig' %}

{% block title %}Créer un article de blog{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        function initMarkdownEditor() {
            const textarea = document.getElementById("markdown-editor");
            if (textarea && !textarea.classList.contains('mde-initialized')) {
                new EasyMDE({
                    element: textarea,
                    spellChecker: false,
                    placeholder: "Rédige ton contenu ici en Markdown...",
                    toolbar: [
                        "bold", "italic","heading-1", "heading-2", "heading-3", "|",
                        "quote", "unordered-list", "ordered-list", "|",
                        "link", "image", "|",
                        "preview", "side-by-side", "fullscreen", "|",
                        "guide",
                        "table"
                    ],
                    autosave: {
                        enabled: true,
                        uniqueId: "blog_content_autosave",
                        delay: 1000,
                    },
                    status: ["lines", "words"]
                });
                textarea.classList.add('mde-initialized');
            }
        }

        // Compatibilité Turbo/Hotwire/Stimulus
        document.addEventListener("turbo:load", initMarkdownEditor);
        document.addEventListener("DOMContentLoaded", initMarkdownEditor);
    </script>
{% endblock %}

{% block body %}
    {% include 'admin/components/Header.html.twig' with {
        title: 'Créer un article de blog',
        subtitle: 'Remplissez les informations ci-dessous pour publier un nouvel article.'
    } %}

    <div class="bg-base-100 p-8 rounded-xl shadow-md border border-base-300 mb-8">
        {{ include('admin/blog_post/_form.html.twig', {'button_label': 'Publier'}) }}

    </div>

    <a href="{{ path('app_admin_blog_post_index') }}" class="btn btn-outline">
        ← Retour à la liste des articles
    </a>
{% endblock %}
