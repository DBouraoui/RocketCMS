{% extends 'admin/base.html.twig' %}

{% block title %}Modifier l’article — {{ blog_post.title }}{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        function initMarkdownEditor() {
            const textarea = document.getElementById("markdown-editor");
            if (textarea && !textarea.classList.contains('mde-initialized')) {
                new EasyMDE({
                    element: textarea,
                    spellChecker: false,
                    placeholder: "Rédige ton contenu ici en Markdown...",
                    toolbar: [
                        "bold", "italic", "heading", "|",
                        "quote", "unordered-list", "ordered-list", "|",
                        "link", "image", "|",
                        "preview", "side-by-side", "fullscreen", "|",
                        "guide"
                    ],
                    autosave: {
                        enabled: true,
                        uniqueId: "blog_content_autosave",
                        delay: 1000,
                    },
                    status: ["lines", "words"]
                });
                textarea.classList.add('mde-initialized');
            }
        }

        // Compatibilité Turbo/Hotwire/Stimulus
        document.addEventListener("turbo:load", initMarkdownEditor);
        document.addEventListener("DOMContentLoaded", initMarkdownEditor);
    </script>
{% endblock %}


{% block body %}
    {% include 'admin/components/Header.html.twig' with {
        title: 'Modifier l’article',
        subtitle: 'Apportez vos changements puis enregistrez-les.'
    } %}

    <div class="bg-base-100 p-8 rounded-xl shadow-md border border-base-300 mb-8">
        {{ include('admin/blog_post/_form.html.twig', {'button_label': 'Mettre à jour'}) }}
    </div>

    <div class="flex justify-between items-center">
        <a href="{{ path('app_admin_blog_post_index') }}" class="btn btn-outline">
            ← Retour à la liste
        </a>

        {{ include('admin/blog_post/_delete_form.html.twig') }}
    </div>
{% endblock %}
